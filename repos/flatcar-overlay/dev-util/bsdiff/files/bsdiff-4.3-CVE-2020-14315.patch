--- a/bspatch.c	2021-01-11 15:53:32.642707355 +0100
+++ b/bspatch.c	2021-01-11 16:00:14.704637769 +0100
@@ -35,6 +35,7 @@
 #include <err.h>
 #include <unistd.h>
 #include <fcntl.h>
+#include <limits.h>
 
 static off_t offtin(u_char *buf)
 {
@@ -152,8 +153,9 @@
 		};
 
 		/* Sanity-check */
-		if ((ctrl[0] < 0) || (ctrl[1] < 0))
-			errx(1,"Corrupt patch\n");
+		if (ctrl[0] < 0 || ctrl[0] > INT_MAX ||
+		    ctrl[1] < 0 || ctrl[1] > INT_MAX)
+			errx(1, "Corrupt patch\n");
 
 		/* Sanity-check */
 		if(newpos+ctrl[0]>newsize)
